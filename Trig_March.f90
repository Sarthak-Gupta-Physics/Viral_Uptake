! Author: Sarthak Gupta !
! Please contact sg207@rice.edu for any questions!

! This code runs the dynamics for the viral uptake simulations !
! Input files are the initial configuration generated by the Initial.f90 code !
! Sphere.dat contains total number of particles on the spherical surface and the 
! number of edges. !
! Sphere_Edge.dat contains the nodes that makes the edge on the sphere !
! sphere_fibonacci_grid_n1000.xyz has the coordinates of the particles on the sphere !

! Mem_*dat contains the dumped trajectory data !

module parameters
implicit none

integer, parameter :: L=60  ! Length of one side simulation box
Real*8  :: Cell_Length,XCELL,YCELL,ZCELL
integer :: NXCELL,NYCELL,NZCELL
integer :: NCELL
integer,dimension(:,:),allocatable :: neigh
integer,dimension(:),allocatable :: HOC,LLIST
integer :: HBOX


integer :: TM,V,Layer,ACE2,CL,NE,NT,NSN,PosV,SVN,POS_ACE2,NVF,NN,NE_Comp,Lx,Comp_Spike,NE_Spike,SS,N_Spike,Vim_Edge
integer :: Sp,Sp_Edge,Comp,Comp_Edge,Comp_Edge_complete
Real*8  :: space

real*8,allocatable,dimension(:)  :: X,Y,Z
real*8,allocatable,dimension(:)  :: RXX,RYY,RZZ ! For applying the repulsive potential with PBC
integer,allocatable,Dimension(:) :: E1,E2
integer,allocatable,Dimension(:) :: E_S1,E_S2
integer,allocatable,Dimension(:) :: P1,P2,P3,N1,N2,N3
real*8,allocatable,dimension(:) :: R_0
Integer :: Total_Time 
Real*8  :: del

Real*8  :: K_Edge,K_Edge_2,K_DH,kb_vim,K_Soft
Real*8  :: K_Tail,K_Stem,K_head,K_ACE2,K_Edge_Sphere
Real*8  :: K_COVID_ACE2,K_Edge_Spike,Kb_Spike

Real*8,allocatable,dimension(:) :: FM_X,FM_Y,FM_Z
Integer,allocatable,dimension(:,:) :: Flag_Ignore,Flag_Contact
integer,allocatable,Dimension(:) :: Occupy_VIM,Occupy_Spike
Real*8 :: r_cut_cm2,depth
Integer :: Comp_Edge_Sphere

Integer :: step,iset,seed,Interval
Real*8  :: dt_M,Mu_M,DT_V
Real*8  :: start, finish
real*8  :: rrr,pie
Real*8  :: Sigma_VIM,Kb_ACER
Real*8  :: Eq_an,Temp_Seed
Real*8 :: r_vim_covid,depth_vim_covid
integer              :: Flag_nei
real*8		     :: drneimax,drneimax2
real*8		     :: r_cut,r_cut2,r_m,r_m2
character*30      :: filename110

Integer :: Flag_ACE2_Spike

Real*8 :: Sigma_Mem,Sigma_Avg


integer :: num_args
character(len=20), dimension(:), allocatable :: args
Real*8  :: Ben,Sp_No,VD,Ens
character*50    :: filename1,filename2,filename3,filename4,filename5
character*50    :: filename6,filename7,filename8


end module parameters




program Trig
use parameters
implicit none
Integer :: I,J,K
real*8, external  :: gauss
	
num_args = command_argument_count()
allocate(args(num_args))  

do i = 1, num_args
  call get_command_argument(i,args(i))
end do

READ(args(1),*)Ben   !then, convert them to REALs
READ(args(2),*)Sp_no	
READ(args(3),*)VD
READ(args(4),*)Ens


Call Initial_Config
Call File_Name

!_____________ Dynamics Parameters ______________!
	Total_Time = 100000000  ! Total Time simulation runs	
	del        = 0.0005	! Delta time
	Dt_M	   = 0.01	! Diffusion Constant
	Dt_V	   = Dt_M	! Diffusion Constant
	Mu_M       = 0.1	! Mobility Constant
	Interval   = 50000       ! Interval for saving positions
	PIE	   = 4.D0*DATAN(1.D0)    ! Value of Pie
!________________________________________________!

!________________    Seed    ____________________!
	Call init_random_seed()
	Call Random_number(Temp_Seed)
	Seed=Temp_Seed*(-10000)
!________________________________________________!

!____________  Two Node Springs _________________!

!   		Membrane			 !
	K_Edge    = 100.d0   ! Spring
	K_Edge_2  = Ben     ! Second Spring

!   		Sphere				 !
	K_Edge_Sphere = 5000.d0 ! Sphere Strength 
	K_Edge_Spike  = 500.d0  ! Spike Strength

!   		Vimentin			 !
	Sigma_VIM = 1.d0
	Sigma_Mem = 1.50 !=space
	Sigma_Avg = (Sigma_Mem+Sigma_VIM)*0.5

	K_Tail    = 100.d0   ! Membrane-Tail
	K_Stem    = 100.d0  ! Vimentin-Stem
	K_Head    = 100.d0   ! Stem-Head
!   		ACE2				 !
	K_ACE2    = 5000.d0  ! ACE2 

!   		ACE2-COVID-Spike			 !
	K_COVID_ACE2=500.d0 ! COVID-ACE2
!________________________________________________!

!______ Three Body Interaction  ___________!
	kb_vim  = 100.d0
	Eq_an	= 1.d0
	Kb_Spike= 100.d0
	Kb_ACER = 500.d0
!________________________________________________!


!=====================Control Parameters For Verlet neighbour's list=======================!					
	r_cut=(2.d0**(1.d0/6.d0))*Sigma_VIM ! Purely repulsive potential cutt-off
	r_cut2=r_cut*r_cut                   
	r_m  =2.5*Sigma_VIM		     ! Cutt-off for finding Neighbours 
	r_m2=r_m*r_m
!==========================================================================================!


!_____________ LJ Angle  ________________________!
	K_Soft=100.d0
	r_vim_covid=4.d0
	depth_vim_covid=105.d0
!________________________________________________!


!_________________ Cell Linked Listing ___________________!
    Cell_Length=Sigma_Mem
    XCELL=Cell_Length
    YCELL=Cell_Length
    ZCELL=Cell_Length		    


    NXCELL=nint(L/Cell_Length)
    NYCELL=NXCELL
    NZCELL=NYCELL
    NCELL=NXCELL*NYCELL*NZCELL

    HBOX=L/2.d0
!_________________________________________________________!
write(45,*)seed,Ben,Sp_no,VD,Ens

allocate(Neigh(0:NCELL-1,0:26))
Do I=0,NCELL-1
	DO J=0,26
		Neigh(I,J)=0
	END Do
END DO
Call Neighbor
allocate(HOC(0:NCELL-1),LLIST(Comp_Spike))





iset=0			        ! Initial flag setting for Gaussian random distribution function
rrr=gauss(seed,iset)	     	! Calling function to set the flag

Flag_nei=0
Flag_ACE2_Spike=0               ! Initially 0, after condition satisfied 1
!___________________ Main Looper _______________!
	Do Step=1,Total_Time
		Call Sorting
		Call Force_Calculation
		Call Update_Positions

                 if( mod(step,interval)==0) Call Save_Pos
	End Do

!_______________________________________________!
end program Trig


	!********** Finding out neighbours of cell ***********
Subroutine Neighbor
use parameters
implicit none
integer :: icell
integer :: ix,iy,iz
integer :: ixx,iyy,izz
integer :: j2,jcell


DO icell = 0,NCELL-1
      iz = int(dble(icell)/dble(NXCELL*NYCELL))
      iy = int(dble(icell-NXCELL*NYCELL*iz)/dble(NXCELL))
      ix = icell-NXCELL*NYCELL*iz-NXCELL*iy

      iz = iz-1    !-    to find the neighbour
      iy = iy-1
      ix = ix-1

      DO  izz = 0,2  ! neighbour cells form cube with (3*3*3)
         IF (iz .LT. 0) THEN     ! 0,2 means 0,1,2
            iz = iz+NZCELL
         END IF
         IF ((iz+izz) .GT. (NZCELL-1)) THEN
            iz = iz-NZCELL
         END IF

         DO iyy = 0,2
           IF (iy .LT. 0) THEN
               iy = iy+NYCELL
           END IF
           IF ((iy+iyy) .GT. (NYCELL-1)) THEN
              iy = iy-NYCELL
           END IF

           DO ixx = 0,2
              IF (ix .LT. 0) THEN
                 ix = ix+NXCELL
              END IF
              IF ((ix+ixx) .GT. (NXCELL-1)) THEN
                 ix = ix-NXCELL
              END IF
              j2 = ixx+3*iyy+9*izz  !bcz unit cell of 3 unit, so in z, pt should be multipd by 3**2 = 9 
              jcell = (ix+ixx)+(iy+iyy)*NXCELL+(iz+izz)*NXCELL*NYCELL ! cell number, j2 is cell index
               neigh(icell,j2) = jcell

           END DO !-ixx loop
        END DO   !-iyy loop
     END DO     !-izz loop
End Do


return
end subroutine Neighbor


         !*******Distribute Particles to the Cells***********!
Subroutine Sorting
use parameters
implicit none
integer :: i
integer :: ic
integer :: icellx,icelly,icellz

  DO I = 0,NCELL-1
     HOC(I) = 0
  END DO

  DO I = 1, Comp_Spike
     icellx = int(RXX(I)/XCELL)!--x-index of cell
     icelly = int(RYY(I)/YCELL)!--y-index of cell
     icellz = int(RZZ(I)/ZCELL)!--z-index of cell
     ic = icellx+icelly*NXCELL+icellz*NXCELL*NYCELL!--index of cell
     LLIST(I) = HOC(ic)
     HOC(ic) = I
  END DO


return
end subroutine Sorting




subroutine Update_Positions
use parameters
implicit none
real*8, external  :: gauss
real*8 		  :: ran2
integer :: I


IF((NVF.GT.Pos_ACE2)) Then
	Do I=1,(CL-ACE2-SVN)
		x(i)=x(i)+ mu_m*(FM_X(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset))
		y(i)=y(i)+ mu_m*(FM_Y(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset))
		z(i)=z(i)+ mu_m*(FM_Z(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset)) 
	End Do

	DO I=(CL-ACE2-SVN)+1,(CL-ACE2)
		x(i)=x(TM+1)
		y(i)=y(TM+1)
		z(i)=z(TM+1) 
	End Do

	Do I=(CL-ACE2)+1,CL
		x(i)=x(i)+ mu_m*(FM_X(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset))
		y(i)=y(i)+ mu_m*(FM_Y(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset))
		z(i)=z(i)+ mu_m*(FM_Z(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset)) 
	End Do

Else
	Do I=1,CL
		x(i)=x(i)+ mu_m*(FM_X(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset))
		y(i)=y(i)+ mu_m*(FM_Y(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset))
		z(i)=z(i)+ mu_m*(FM_Z(I))*del  + ((sqrt(2.0*Dt_M*del))*gauss(seed,iset)) 
	End Do
End iF


Do I=CL+1,Comp_Spike
	x(i)=x(i)+ mu_m*(FM_X(I))*del  + ((sqrt(2.0*Dt_V*del))*gauss(seed,iset))
	y(i)=y(i)+ mu_m*(FM_Y(I))*del  + ((sqrt(2.0*Dt_V*del))*gauss(seed,iset))
	z(i)=z(i)+ mu_m*(FM_Z(I))*del  + ((sqrt(2.0*Dt_V*del))*gauss(seed,iset)) 
End Do


! For repulsive potential with PBC !
Do I=1,Comp_Spike
	RXX(I)=X(I)
	RYY(I)=Y(I)
	RZZ(I)=Z(I)

	RXX(i)=RXX(i)-( floor(RXX(i)/L) ) * L
	RYY(i)=RYY(i)-( floor(RYY(i)/L) ) * L
	RZZ(i)=RZZ(i)-( floor(RZZ(i)/L) ) * L
End Do


return
end subroutine Update_Positions



subroutine Save_Pos
use parameters
implicit none
integer :: I

Do I=1,Comp_Spike
	write(100) x(i),y(i),z(i)
End Do


End subroutine Save_Pos

subroutine Force_Calculation
use parameters
implicit none
real*8,dimension(Comp_Spike) :: Fx_Edge,Fy_Edge,Fz_Edge
real*8,dimension(Comp_Spike) :: Fx_DH,Fy_DH,Fz_DH
real*8,dimension(Comp_Spike) :: Fx_SNN,Fy_SNN,Fz_SNN ! Second Nearest neighbour
real*8,dimension(Comp_Spike) :: Fx_LJ,Fy_LJ,Fz_LJ
real*8,dimension(Comp_Spike) :: fx_ang,fy_ang,fz_ang
integer :: I,J,K,Ed1,Ed2,ll
integer :: STNEI,nnei,jj
real*8  :: dis,r,const
real*8  :: XR,YR,ZR
real*8  :: ffx,ffy,ffz

Integer :: K_Vim,K_Spike

integer :: q0,q1,q2,q3,a,b,c,d
Real*8  :: AA,BB,CC,DD,EE,FF
Real*8  :: b0x,b0y,b0z,b1x,b1y,b1z,b2x,b2y,b2z
Real*8  :: Cos_Phi,Phi


Real*8  :: FM_X_Total,FM_Y_Total,FM_Z_Total

real*8 :: bax,bay,baz,bcx,bcy,bcz
real*8 :: cdx,cdy,cdz,cbx,cby,cbz
real*8 :: babc_X,babc_Y,babc_Z
real*8 :: cdcb_X,cdcb_Y,cdcb_Z
real*8 :: p1_mag,p2_mag
real*8 :: p1x,p1y,p1z,p2x,p2y,p2z

real*8 :: abx,aby,abz,ab_mag
real*8 :: cb_mag,cd_mag
real*8 :: Cos_Theta_1,Cos_Theta_2
real*8 :: bc_mag
real*8 :: dcx,dcy,dcz,dc_mag
real*8 :: Sin_Phi,Sin_Theta_1,Sin_Theta_2

real*8 :: ox,oy,oz
Real*8 :: ocx,ocy,ocz,oc_mag
Real*8 :: ocF_DH_X,ocF_DH_Y,ocF_DH_Z
Real*8 :: cdF_DH_X,cdF_DH_Y,cdF_DH_Z
Real*8 :: baF_DH_X,baF_DH_Y,baF_DH_Z
Real*8 :: tcx,tcy,tcz
Real*8 :: tcoc_X,tcoc_Y,tcoc_Z
Real*8 :: Cos_Theta,Theta,Sin_Theta

Real*8  :: ratio_1,ratio_2,fff

integer :: s1,t1,v1
real*8  :: x21,y21,z21,x32,y32,z32
real*8  :: r21,r32
real*8  :: cost3
real*8	:: t1x0,t1x1,t1x2,t1y0,t1y1,t1y2,t1z0,t1z1,t1z2
real*8	:: t3x0,t3x1,t3x2,t3y0,t3y1,t3y2,t3z0,t3z1,t3z2
real*8  :: px,py,pz,rx,ry,rz





integer  :: cellx,celly,cellz
integer  :: js,cell,jcell,M
Real*8   :: X1,Y1,Z1,X2,Y2,Z2


integer :: i1
Real,dimension(:),allocatable :: Contact

	Do I=1,Comp_Spike
		FM_X(I)=0.d0
		FM_Y(I)=0.d0
		FM_Z(I)=0.d0

		Fx_Edge(I)=0.d0
		Fy_Edge(I)=0.d0
		Fz_Edge(I)=0.d0
	
		Fx_DH(I)=0.d0
		Fy_DH(I)=0.d0
		Fz_DH(I)=0.d0

		Fx_SNN(I)=0.d0
		Fy_SNN(I)=0.d0
		Fz_SNN(I)=0.d0


		fx_ang(I)=0.d0
		fy_ang(I)=0.d0
		fz_ang(I)=0.d0


		Fx_LJ(I)=0.d0
		Fy_LJ(I)=0.d0
		Fz_LJ(I)=0.d0

	End Do

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!____________  Membrane  ______________!

!_____________ Edge Springs ___________!
	Do I=1,NE

		Ed1=E1(I)
		Ed2=E2(I)

		Flag_Ignore(Ed1,Ed2)=1

		XR=X(Ed1)-X(Ed2)
		YR=Y(Ed1)-Y(Ed2)
		ZR=Z(Ed1)-Z(Ed2)

		Dis=sqrt( XR*XR + YR*YR + ZR*ZR)

		r=dis-space
		const=(-1.d0)*(K_Edge/(real(dis)))

		ffx=(const*r)*xr
		ffy=(const*r)*yr
		ffz=(const*r)*zr

		Fx_Edge(Ed1)=Fx_Edge(Ed1)+ffx
		Fx_Edge(Ed2)=Fx_Edge(Ed2)-ffx	
		Fy_Edge(Ed1)=Fy_Edge(Ed1)+ffy
		Fy_Edge(Ed2)=Fy_Edge(Ed2)-ffy
		Fz_Edge(Ed1)=Fz_Edge(Ed1)+ffz
		Fz_Edge(Ed2)=Fz_Edge(Ed2)-ffz

	End Do

!______________________________________!



!_____Second Edge Springs ___________!
	Do I=1,NSN

		Ed1=E_S1(I)
		Ed2=E_S2(I)

		!Flag_Ignore(Ed1,Ed2)=1

		XR=X(Ed1)-X(Ed2)
		YR=Y(Ed1)-Y(Ed2)
		ZR=Z(Ed1)-Z(Ed2)

		Dis=sqrt( XR*XR + YR*YR + ZR*ZR)

		r=dis-(2.d0*space*sin(Pie/3.d0))
		const=(-1.d0)*(K_Edge_2/(real(dis)))

		ffx=(const*r)*xr
		ffy=(const*r)*yr
		ffz=(const*r)*zr

		Fx_SNN(Ed1)=Fx_SNN(Ed1)+ffx
		Fx_SNN(Ed2)=Fx_SNN(Ed2)-ffx	
		Fy_SNN(Ed1)=Fy_SNN(Ed1)+ffy
		Fy_SNN(Ed2)=Fy_SNN(Ed2)-ffy
		Fz_SNN(Ed1)=Fz_SNN(Ed1)+ffz
		Fz_SNN(Ed2)=Fz_SNN(Ed2)-ffz

	End Do


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!____________  Vimentin  ______________!
!_____   Membrane-Vimentin Tail _______!

Do I=NE+1,Comp_Edge
		Ed1=E1(I)
		Ed2=E2(I)

		FLAG_IGNORE(Ed1,Ed2)=1

		XR=X(Ed1)-X(Ed2)
		YR=Y(Ed1)-Y(Ed2)
		ZR=Z(Ed1)-Z(Ed2)

		Dis=sqrt( XR*XR + YR*YR + ZR*ZR)

		!print*,I,dis

		r=dis-Sigma_VIM
		const=(-1.d0)*(K_Stem/(real(dis)))

		ffx=(const*r)*xr
		ffy=(const*r)*yr
		ffz=(const*r)*zr

		Fx_Edge(Ed1)=Fx_Edge(Ed1)+ffx
		Fx_Edge(Ed2)=Fx_Edge(Ed2)-ffx	
		Fy_Edge(Ed1)=Fy_Edge(Ed1)+ffy
		Fy_Edge(Ed2)=Fy_Edge(Ed2)-ffy
		Fz_Edge(Ed1)=Fz_Edge(Ed1)+ffz
		Fz_Edge(Ed2)=Fz_Edge(Ed2)-ffz
	End Do


!_____________ Sphere Springs ___________!

	Do I=Comp_Edge+1,Comp_Edge_Sphere
		Ed1=E1(I)
		Ed2=E2(I)

		FLAG_IGNORE(Ed1,Ed2)=1

		XR=X(Ed1)-X(Ed2)
		YR=Y(Ed1)-Y(Ed2)
		ZR=Z(Ed1)-Z(Ed2)

		Dis=sqrt( XR*XR + YR*YR + ZR*ZR)

		!print*,I,dis

		r=dis-R_0(I)
		const=(-1.d0)*(K_Edge_Sphere/(real(dis)))

		ffx=(const*r)*xr
		ffy=(const*r)*yr
		ffz=(const*r)*zr

		Fx_Edge(Ed1)=Fx_Edge(Ed1)+ffx
		Fx_Edge(Ed2)=Fx_Edge(Ed2)-ffx	
		Fy_Edge(Ed1)=Fy_Edge(Ed1)+ffy
		Fy_Edge(Ed2)=Fy_Edge(Ed2)-ffy
		Fz_Edge(Ed1)=Fz_Edge(Ed1)+ffz
		Fz_Edge(Ed2)=Fz_Edge(Ed2)-ffz
	End Do
!_____________ Spike Springs ___________!
	Do I=Comp_Edge_Sphere+1,Comp_Edge_complete
		Ed1=E1(I)
		Ed2=E2(I)

		FLAG_IGNORE(Ed1,Ed2)=1

		XR=X(Ed1)-X(Ed2)
		YR=Y(Ed1)-Y(Ed2)
		ZR=Z(Ed1)-Z(Ed2)

		Dis=sqrt( XR*XR + YR*YR + ZR*ZR)

		!print*,I,dis

		r=dis-Sigma_VIM
		const=(-1.d0)*(K_Edge_Spike/(real(dis)))

		ffx=(const*r)*xr
		ffy=(const*r)*yr
		ffz=(const*r)*zr

		Fx_Edge(Ed1)=Fx_Edge(Ed1)+ffx
		Fx_Edge(Ed2)=Fx_Edge(Ed2)-ffx	
		Fy_Edge(Ed1)=Fy_Edge(Ed1)+ffy
		Fy_Edge(Ed2)=Fy_Edge(Ed2)-ffy
		Fz_Edge(Ed1)=Fz_Edge(Ed1)+ffz
		Fz_Edge(Ed2)=Fz_Edge(Ed2)-ffz
	End Do

!______________________________________!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




!____________  ACE2  __________________!
!_________ Membrane - ACE2  ___________!

			i=POS_ACE2
			j=Layer+1

			FLAG_IGNORE(i,j)=1

			XR=X(i)-X(j)
			YR=Y(i)-Y(j)
			ZR=Z(i)-Z(j)

			Dis=sqrt( XR*XR + YR*YR + ZR*ZR)

			r=dis-Sigma_VIM
			const=(-1.d0)*(K_ACE2/(real(dis)))

			ffx=(const*r)*xr
			ffy=(const*r)*yr
			ffz=(const*r)*zr

			Fx_Edge(i)=Fx_Edge(i)+ffx
			Fx_Edge(j)=Fx_Edge(j)-ffx	
			Fy_Edge(i)=Fy_Edge(i)+ffy
			Fy_Edge(j)=Fy_Edge(j)-ffy
			Fz_Edge(i)=Fz_Edge(i)+ffz
			Fz_Edge(j)=Fz_Edge(j)-ffz

!_______________ ACE2  ________________!

		Do i=Layer+1,CL-1
			j=I+1

			FLAG_IGNORE(i,j)=1
	
			!print*,i,j
	
			XR=X(i)-X(j)
			YR=Y(i)-Y(j)
			ZR=Z(i)-Z(j)

			Dis=sqrt( XR*XR + YR*YR + ZR*ZR)

			r=dis-Sigma_VIM
			const=(-1.d0)*(K_ACE2/(real(dis)))

			ffx=(const*r)*xr
			ffy=(const*r)*yr
			ffz=(const*r)*zr

			Fx_Edge(i)=Fx_Edge(i)+ffx
			Fx_Edge(j)=Fx_Edge(j)-ffx	
			Fy_Edge(i)=Fy_Edge(i)+ffy
			Fy_Edge(j)=Fy_Edge(j)-ffy
			Fz_Edge(i)=Fz_Edge(i)+ffz
			Fz_Edge(j)=Fz_Edge(j)-ffz

		End do




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!   Three Body for Vimentin Filaments  !
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! SVN particles in Vimentin
! Plus a membrane particle for each
! Total SVN + 1 particles in each vimentin
! Thus, Number of Edges=SVN+1-1=SVN
! and, No. of 3-Body angles=SVN-1

Do I=NE+1,Comp_Edge-1,SVN
			s1=E1(I)
			t1=E2(I)
			v1=E2(I+1)
			
			x21=x(t1)-x(s1)
			y21=y(t1)-y(s1)
			z21=z(t1)-z(s1)

			x32=x(v1)-x(t1)
			y32=y(v1)-y(t1)
			z32=z(v1)-z(t1)

			r21=sqrt(x21*x21+y21*y21+z21*z21)
			r32=sqrt(x32*x32+y32*y32+z32*z32)

			cost3=((x21*x32)+(y21*y32)+(z21*z32))/ (r21*r32)


			t1x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1x1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*x21)
			t1x2= t1x0* x32
			t1y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1y1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*y21)
			t1y2= t1x0* y32
			t1z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1z1= t1z0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*z21)
			t1z2= t1z0* z32



			t3x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3x1= t3x0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*x32
			t3x2= t3x0* x21
			t3y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3y1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*y32
			t3y2= t3y0* y21
			t3z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3z1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*z32
			t3z2= t3y0* z21


			px=-(t1x1-t1x2)*kb_vim
			py=-(t1y1-t1y2)*kb_vim
			pz=-(t1z1-t1z2)*kb_vim

			rx=(t3x1-t3x2)*kb_vim
			ry=(t3y1-t3y2)*kb_vim
			rz=(t3z1-t3z2)*kb_vim



			fx_ang(s1)=fx_ang(s1)+px
			fy_ang(s1)=fy_ang(s1)+py
			fz_ang(s1)=fz_ang(s1)+pz	


			fx_ang(v1)=fx_ang(v1)+rx
			fy_ang(v1)=fy_ang(v1)+ry
			fz_ang(v1)=fz_ang(v1)+rz	


			fx_ang(t1)=fx_ang(t1)-px-rx
			fy_ang(t1)=fy_ang(t1)-py-ry
			fz_ang(t1)=fz_ang(t1)-pz-rz	
End Do

Do I=NE+2,Comp_Edge-1,SVN
			s1=E1(I)
			t1=E2(I)
			v1=E2(I+1)
		
			x21=x(t1)-x(s1)
			y21=y(t1)-y(s1)
			z21=z(t1)-z(s1)

			x32=x(v1)-x(t1)
			y32=y(v1)-y(t1)
			z32=z(v1)-z(t1)

			r21=sqrt(x21*x21+y21*y21+z21*z21)
			r32=sqrt(x32*x32+y32*y32+z32*z32)

			cost3=((x21*x32)+(y21*y32)+(z21*z32))/ (r21*r32)


			t1x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1x1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*x21)
			t1x2= t1x0* x32
			t1y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1y1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*y21)
			t1y2= t1x0* y32
			t1z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1z1= t1z0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*z21)
			t1z2= t1z0* z32



			t3x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3x1= t3x0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*x32
			t3x2= t3x0* x21
			t3y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3y1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*y32
			t3y2= t3y0* y21
			t3z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3z1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*z32
			t3z2= t3y0* z21


			px=-(t1x1-t1x2)*kb_vim
			py=-(t1y1-t1y2)*kb_vim
			pz=-(t1z1-t1z2)*kb_vim

			rx=(t3x1-t3x2)*kb_vim
			ry=(t3y1-t3y2)*kb_vim
			rz=(t3z1-t3z2)*kb_vim



			fx_ang(s1)=fx_ang(s1)+px
			fy_ang(s1)=fy_ang(s1)+py
			fz_ang(s1)=fz_ang(s1)+pz	


			fx_ang(v1)=fx_ang(v1)+rx
			fy_ang(v1)=fy_ang(v1)+ry
			fz_ang(v1)=fz_ang(v1)+rz	


			fx_ang(t1)=fx_ang(t1)-px-rx
			fy_ang(t1)=fy_ang(t1)-py-ry
			fz_ang(t1)=fz_ang(t1)-pz-rz
End Do

Do I=NE+3,Comp_Edge-1,SVN
			s1=E1(I)
			t1=E2(I)
			v1=E2(I+1)
			x21=x(t1)-x(s1)
			y21=y(t1)-y(s1)
			z21=z(t1)-z(s1)

			x32=x(v1)-x(t1)
			y32=y(v1)-y(t1)
			z32=z(v1)-z(t1)

			r21=sqrt(x21*x21+y21*y21+z21*z21)
			r32=sqrt(x32*x32+y32*y32+z32*z32)

			cost3=((x21*x32)+(y21*y32)+(z21*z32))/ (r21*r32)


			t1x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1x1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*x21)
			t1x2= t1x0* x32
			t1y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1y1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*y21)
			t1y2= t1x0* y32
			t1z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1z1= t1z0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*z21)
			t1z2= t1z0* z32



			t3x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3x1= t3x0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*x32
			t3x2= t3x0* x21
			t3y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3y1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*y32
			t3y2= t3y0* y21
			t3z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3z1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*z32
			t3z2= t3y0* z21


			px=-(t1x1-t1x2)*kb_vim
			py=-(t1y1-t1y2)*kb_vim
			pz=-(t1z1-t1z2)*kb_vim

			rx=(t3x1-t3x2)*kb_vim
			ry=(t3y1-t3y2)*kb_vim
			rz=(t3z1-t3z2)*kb_vim



			fx_ang(s1)=fx_ang(s1)+px
			fy_ang(s1)=fy_ang(s1)+py
			fz_ang(s1)=fz_ang(s1)+pz	


			fx_ang(v1)=fx_ang(v1)+rx
			fy_ang(v1)=fy_ang(v1)+ry
			fz_ang(v1)=fz_ang(v1)+rz	


			fx_ang(t1)=fx_ang(t1)-px-rx
			fy_ang(t1)=fy_ang(t1)-py-ry
			fz_ang(t1)=fz_ang(t1)-pz-rz
End Do

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!          Three Body for ACE2         !
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!______ACE2-Membrane Connection________!

		s1=POS_ACE2
		t1=Layer+1
		v1=Layer+2
			
			x21=x(t1)-x(s1)
			y21=y(t1)-y(s1)
			z21=z(t1)-z(s1)

			x32=x(v1)-x(t1)
			y32=y(v1)-y(t1)
			z32=z(v1)-z(t1)

			r21=sqrt(x21*x21+y21*y21+z21*z21)
			r32=sqrt(x32*x32+y32*y32+z32*z32)

			cost3=((x21*x32)+(y21*y32)+(z21*z32))/ (r21*r32)


			t1x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1x1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*x21)
			t1x2= t1x0* x32
			t1y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1y1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*y21)
			t1y2= t1x0* y32
			t1z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1z1= t1z0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*z21)
			t1z2= t1z0* z32



			t3x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3x1= t3x0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*x32
			t3x2= t3x0* x21
			t3y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3y1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*y32
			t3y2= t3y0* y21
			t3z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3z1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*z32
			t3z2= t3y0* z21


			px=-(t1x1-t1x2)*Kb_ACER
			py=-(t1y1-t1y2)*Kb_ACER
			pz=-(t1z1-t1z2)*Kb_ACER

			rx=(t3x1-t3x2)*Kb_ACER
			ry=(t3y1-t3y2)*Kb_ACER
			rz=(t3z1-t3z2)*Kb_ACER



			fx_ang(s1)=fx_ang(s1)+px
			fy_ang(s1)=fy_ang(s1)+py
			fz_ang(s1)=fz_ang(s1)+pz	


			fx_ang(v1)=fx_ang(v1)+rx
			fy_ang(v1)=fy_ang(v1)+ry
			fz_ang(v1)=fz_ang(v1)+rz	


			fx_ang(t1)=fx_ang(t1)-px-rx
			fy_ang(t1)=fy_ang(t1)-py-ry
			fz_ang(t1)=fz_ang(t1)-pz-rz	




!_____________ Body of ACE2 ___________!
		do s1=Layer+1,CL-2	!Bending for all monomers of docking REC acceptor.
			t1=s1+1
			v1=s1+2

			!print*,s1,t1,v1
			x21=x(t1)-x(s1)
			y21=y(t1)-y(s1)
			z21=z(t1)-z(s1)

			x32=x(v1)-x(t1)
			y32=y(v1)-y(t1)
			z32=z(v1)-z(t1)

			r21=sqrt(x21*x21+y21*y21+z21*z21)
			r32=sqrt(x32*x32+y32*y32+z32*z32)

			cost3=((x21*x32)+(y21*y32)+(z21*z32))/ (r21*r32)


			t1x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1x1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*x21)
			t1x2= t1x0* x32
			t1y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1y1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*y21)
			t1y2= t1x0* y32
			t1z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1z1= t1z0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*z21)
			t1z2= t1z0* z32



			t3x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3x1= t3x0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*x32
			t3x2= t3x0* x21
			t3y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3y1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*y32
			t3y2= t3y0* y21
			t3z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3z1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*z32
			t3z2= t3y0* z21


			px=-(t1x1-t1x2)*Kb_ACER
			py=-(t1y1-t1y2)*Kb_ACER
			pz=-(t1z1-t1z2)*Kb_ACER

			rx=(t3x1-t3x2)*Kb_ACER
			ry=(t3y1-t3y2)*Kb_ACER
			rz=(t3z1-t3z2)*Kb_ACER



			fx_ang(s1)=fx_ang(s1)+px
			fy_ang(s1)=fy_ang(s1)+py
			fz_ang(s1)=fz_ang(s1)+pz	


			fx_ang(v1)=fx_ang(v1)+rx
			fy_ang(v1)=fy_ang(v1)+ry
			fz_ang(v1)=fz_ang(v1)+rz	


			fx_ang(t1)=fx_ang(t1)-px-rx
			fy_ang(t1)=fy_ang(t1)-py-ry
			fz_ang(t1)=fz_ang(t1)-pz-rz	    
		end do




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!   Three Body for Spike	       !
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

Do I=Comp_Edge_Sphere+1,Comp_Edge_complete-1,SS
			s1=E1(I)
			t1=E2(I)
			v1=E2(I+1)


			!print*,s1,t1,v1
			x21=x(t1)-x(s1)
			y21=y(t1)-y(s1)
			z21=z(t1)-z(s1)

			x32=x(v1)-x(t1)
			y32=y(v1)-y(t1)
			z32=z(v1)-z(t1)

			r21=sqrt(x21*x21+y21*y21+z21*z21)
			r32=sqrt(x32*x32+y32*y32+z32*z32)

			cost3=((x21*x32)+(y21*y32)+(z21*z32))/ (r21*r32)

			!print*,I,s1,t1,v1,acos(cost3)*(180.d0/PIE)

			t1x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1x1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*x21)
			t1x2= t1x0* x32
			t1y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1y1= t1x0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*y21)
			t1y2= t1x0* y32
			t1z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t1z1= t1z0*( ((x32*x21 + y32*y21 + z32*z21)/(r21**2))*z21)
			t1z2= t1z0* z32



			t3x0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3x1= t3x0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*x32
			t3x2= t3x0* x21
			t3y0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3y1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*y32
			t3y2= t3y0* y21
			t3z0=(cost3-Eq_an)* ((r32*r21)**(-1)) 
			t3z1= t3y0*((x32*x21 + y32*y21 + z32*z21)/(r32**2))*z32
			t3z2= t3y0* z21


			px=-(t1x1-t1x2)*Kb_Spike
			py=-(t1y1-t1y2)*Kb_Spike
			pz=-(t1z1-t1z2)*Kb_Spike

			rx=(t3x1-t3x2)*Kb_Spike
			ry=(t3y1-t3y2)*Kb_Spike
			rz=(t3z1-t3z2)*Kb_Spike



			fx_ang(s1)=fx_ang(s1)+px
			fy_ang(s1)=fy_ang(s1)+py
			fz_ang(s1)=fz_ang(s1)+pz	


			fx_ang(v1)=fx_ang(v1)+rx
			fy_ang(v1)=fy_ang(v1)+ry
			fz_ang(v1)=fz_ang(v1)+rz	


			fx_ang(t1)=fx_ang(t1)-px-rx
			fy_ang(t1)=fy_ang(t1)-py-ry
			fz_ang(t1)=fz_ang(t1)-pz-rz	    
end do


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!_____________ACE2 COVID-Spike _______________!

	 	i=CL
		j=Comp+SS
		FLAG_IGNORE(i,j)=1
		!print*,i,j,"fsaf"
	
		XR=X(i)-X(j)
		YR=Y(i)-Y(j)
		ZR=Z(i)-Z(j)

		Dis=sqrt( XR*XR + YR*YR + ZR*ZR)

		r=dis-Sigma_VIM
		const=(-1.d0)*(K_COVID_ACE2/(real(dis)))

		ffx=(const*r)*xr
		ffy=(const*r)*yr
		ffz=(const*r)*zr

		Fx_Edge(i)=Fx_Edge(i)+ffx
		Fx_Edge(j)=Fx_Edge(j)-ffx	
		Fy_Edge(i)=Fy_Edge(i)+ffy
		Fy_Edge(j)=Fy_Edge(j)-ffy
		Fz_Edge(i)=Fz_Edge(i)+ffz
		Fz_Edge(j)=Fz_Edge(j)-ffz
!_________________________________________________!

!_____________Vimentin COVID- Spike ______________!
! Head of Vimentin filament attracts to the the   !
!                  Spike Head                     !
!          Except ACE2-Spike connection           !
! In this code, we are letting spike attracted to !
! only to the nearest vimentin and no other vimentin!

! First Calculate all the distance from Jth spike particle	 !
! to all the surface vimentin particles.         		 !
! Then only, which are in cuttoff are recorded in "Contact" array!
! Among the particles clearing the cutoff, find the nearest monomer !
! By finding minloc, the location of lowest distance!
! and use this vimentin particle i1 to find attraction with jth spike!
! One Spike can only attach to one vimentin !


Do K_Spike=1,N_Spike
j=Cl+Sp+(K_spike*SS)
IF(j==(comp+ss)) cycle
	IF (Occupy_Spike(J) .eq. 0) Then
		do K_Vim=1,NVF
		IF(K_Vim==NN) cycle
		i=TM+(K_Vim*SVN)
			IF (Occupy_VIM(I) .eq. 0) Then

				xr=x(i)-x(j)          
				yr=y(i)-y(j)
				zr=z(i)-z(j)          

				dis= xr*xr + yr*yr + zr*zr

				if(dis.lt.r_vim_covid) then
					Occupy_Spike(J)=I
					Occupy_Vim(I)=1

					i1=Occupy_Spike(J)
					FLAG_IGNORE(i1,j)=1
					ratio_1=1.d0/dis
					ratio_2=ratio_1*ratio_1*ratio_1
					fff=((48.d0*depth_vim_covid*ratio_1*ratio_2)*(ratio_2-0.5))
					FX_LJ(i1)=FX_LJ(i1)+(fff*xr)
					FX_LJ(j)=FX_LJ(j)-(fff*xr)
					FY_LJ(i1)=FY_LJ(i1)+(fff*yr)
					FY_LJ(j)=FY_LJ(j)-(fff*yr)
					FZ_LJ(i1)=FZ_LJ(i1)+(fff*zr)
					FZ_LJ(j)=FZ_LJ(j)-(fff*zr)
					exit
				end if

			END IF
		end do

	ELSE 
		i1=Occupy_Spike(J)
		xr=x(i1)-x(j)          
		yr=y(i1)-y(j)
		zr=z(i1)-z(j)          

		dis= xr*xr + yr*yr + zr*zr
		
		if(dis.lt.r_vim_covid) then
			FLAG_IGNORE(i1,j)=1
			ratio_1=1.d0/dis
			ratio_2=ratio_1*ratio_1*ratio_1
			fff=((48.d0*depth_vim_covid*ratio_1*ratio_2)*(ratio_2-0.5))
			FX_LJ(i1)=FX_LJ(i1)+(fff*xr)
			FX_LJ(j)=FX_LJ(j)-(fff*xr)
			FY_LJ(i1)=FY_LJ(i1)+(fff*yr)
			FY_LJ(j)=FY_LJ(j)-(fff*yr)
			FZ_LJ(i1)=FZ_LJ(i1)+(fff*zr)
			FZ_LJ(j)=FZ_LJ(j)-(fff*zr)
		end if


	END IF



end do

! Purely repulsive soft potential for all the monomers which
! doesn't have any other interactions.
DO I = 1,Comp_Spike
	
		X1 = RXX(I)
		Y1 = RYY(I)
		Z1 = RZZ(I)

		cellx = int(RXX(I)/XCELL)                         !--x-index of cell
		celly = int(RYY(I)/YCELL)                         !--y-index of cell
		cellz = int(RZZ(I)/ZCELL)                         !--z-index of cell
		cell = cellx + celly*NXCELL + cellz*NXCELL*NYCELL!--index of cell having this catalytic particle

		DO M = 0,26
			jcell = neigh(cell,M)
			Js    = HOC(jcell)				 !--Head particle of a cell
			
				DO WHILE (Js .NE. 0)
						IF(Flag_Ignore(i,js)==1) then	! Ignore this interaction, if there is another interaction
						Else
							X2 = RXX(js)
							Y2 = RYY(js)
							Z2 = RZZ(js)

							xr=X1-X2
							yr=Y1-Y2
							zr=Z1-Z2

							xr=xr-(L*nint(xr/L))
							yr=yr-(L*nint(yr/L))
							zr=zr-(L*nint(zr/L))


							dis= sqrt(xr*xr + yr*yr + zr*zr)
					
							IF(I.LE.TM) THEN
							
							if((dis.lt.Sigma_AVG).and.(js.gt.i)) then
									r=dis-Sigma_AVG
									const=(-1.d0)*(K_Soft/(real(dis)))

									ffx=(const*r)*xr
									ffy=(const*r)*yr
									ffz=(const*r)*zr

									fx_LJ(i)=fx_LJ(i)+ffx
									fx_LJ(js)=fx_LJ(js)-ffx
									fy_LJ(i)=fy_LJ(i)+ffy
									fy_LJ(js)=fy_LJ(js)-ffy
									fz_LJ(i)=fz_LJ(i)+ffz
									fz_LJ(js)=fz_LJ(js)-ffz	
					        	 end if       !--dd.lt.cutoffsq1
							ELSE
							if((dis.lt.Sigma_VIM).and.(js.gt.i)) then
									r=dis-Sigma_VIM
									const=(-1.d0)*(K_Soft/(real(dis)))

									ffx=(const*r)*xr
									ffy=(const*r)*yr
									ffz=(const*r)*zr

									fx_LJ(i)=fx_LJ(i)+ffx
									fx_LJ(js)=fx_LJ(js)-ffx
									fy_LJ(i)=fy_LJ(i)+ffy
									fy_LJ(js)=fy_LJ(js)-ffy
									fz_LJ(i)=fz_LJ(i)+ffz
									fz_LJ(js)=fz_LJ(js)-ffz	
					        	 end if       !--dd.lt.cutoffsq1
							END IF

							
						End IF 
					Js = LLIST(Js)   !--goto next particle of the cells
				END DO               !--do while j .ne.0 loop
		END DO                  !--m =0,26 loop
End Do
!_______________________________________________________________________________________________!

!______  Force on Ith particle _______!
	Do I=1,Comp_Spike
		FM_X(I)=FM_X(I)+Fx_Edge(I) + FX_LJ(I)  + FX_SNN(I) + fx_ang(I)
		FM_Y(I)=FM_Y(I)+Fy_Edge(I) + FY_LJ(I)  + FY_SNN(I) + fy_ang(I)
		FM_Z(I)=FM_Z(I)+Fz_Edge(I) + FZ_LJ(I)  + FZ_SNN(I) + fz_ang(I)
	End Do
!______________________________________!

End Subroutine Force_Calculation



Subroutine Initial_Config
use parameters
implicit none
integer :: i,j,k
integer :: Ed1,Ed2
real*8 :: xr,yr,zr

if( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i1,a1,i1,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i1,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i1,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"



elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i1,a1,i1,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i1,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i1,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i1,a1,i1,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i1,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i1,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i1,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i1,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i1,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i1,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i1,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i1,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i1,a1,i2,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i2,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i2,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i1,a1,i2,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i2,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i2,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i1,a1,i2,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i2,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i2,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i2,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i2,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i2,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i2,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i2,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i2,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i1,a1,i3,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i3,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i3,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i1,a1,i3,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i3,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i3,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i1,a1,i3,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i1,a1,i3,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i1,a1,i3,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i1,a1,i3,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i1,a1,i3,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i1,a1,i3,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i1,a1,i3,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i1,a1,i3,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i1,a1,i3,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
!___________________________________________________________________________________________________________!

elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i2,a1,i1,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i1,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i1,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i2,a1,i1,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i1,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i1,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i2,a1,i1,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i1,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i1,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i1,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i1,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i1,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i1,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i1,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i1,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i2,a1,i2,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i2,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i2,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i2,a1,i2,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i2,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i2,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i2,a1,i2,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i2,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i2,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i2,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i2,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i2,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i2,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i2,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i2,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i2,a1,i3,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i3,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i3,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i2,a1,i3,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i3,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i3,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i2,a1,i3,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i2,a1,i3,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i2,a1,i3,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i2,a1,i3,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i2,a1,i3,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i2,a1,i3,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i2,a1,i3,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i2,a1,i3,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i2,a1,i3,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
!______________________________________________________________________________________________________________!

elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i3,a1,i1,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i1,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i1,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i3,a1,i1,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i1,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i1,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i3,a1,i1,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i1,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i1,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i1,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i1,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i1,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i1,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i1,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i1,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"



elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i3,a1,i2,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i2,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i2,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i3,a1,i2,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i2,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i2,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i3,a1,i2,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i2,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i2,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i2,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i2,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i2,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i2,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i2,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i2,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename1,'(a8,i3,a1,i3,a1,i1,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i1,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i1,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i1,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i1,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i1,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i1,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i3,a1,i1,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i1,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i1,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i1,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i1,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i1,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i1,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i3,a1,i1,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i1,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i1,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i1,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i1,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i1,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i1,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i3,a1,i3,a1,i2,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i2,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i2,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i2,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i2,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i2,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i2,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i3,a1,i2,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i2,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i2,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i2,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i2,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i2,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i2,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i3,a1,i2,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i2,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i2,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i2,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i2,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i2,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i2,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename1,'(a8,i3,a1,i3,a1,i3,a1,i1,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i3,a1,i1,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i3,a1,i1,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i3,a1,i1,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i3,a1,i1,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i3,a1,i1,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i3,a1,i1,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename1,'(a8,i3,a1,i3,a1,i3,a1,i2,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i3,a1,i2,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i3,a1,i2,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i3,a1,i2,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i3,a1,i2,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i3,a1,i2,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i3,a1,i2,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename1,'(a8,i3,a1,i3,a1,i3,a1,i3,a4)')"Tri_seed",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename2,'(a9,i3,a1,i3,a1,i3,a1,i3,a4)')"Tri_Nodes",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename3,'(a9,i3,a1,i3,a1,i3,a1,i3,a4)')"Tri_Edges",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename4,'(a9,i3,a1,i3,a1,i3,a1,i3,a4)')"Tri_Faces",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename5,'(a13,i3,a1,i3,a1,i3,a1,i3,a4)')"Triangle_data",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename6,'(a9,i3,a1,i3,a1,i3,a1,i3,a4)')"Tri_Neigh",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
WRITE(filename7,'(a13,i3,a1,i3,a1,i3,a1,i3,a4)')"Tri_Neigh_Sec",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
end if

!__________________________________________________________________________________________________!


Open(unit=45,file=filename1)

Open(unit=10,file=filename2)
Open(unit=20,file=filename3)
Open(unit=30,file=filename4)
Open(unit=40,file=filename5)
Open(unit=50,file=filename6)
Open(unit=60,file=filename7)

Read(40,*) TM,V,Layer,ACE2,CL,NE,NT,space,NSN,PosV,SVN,POS_ACE2,NVF,NN,NE_Comp,Lx,Comp_Spike,NE_Spike,SS,N_Spike,Vim_Edge
Open (unit=400,file="Sphere_Data.dat")
Read(400,*) Sp,Sp_Edge


Comp=Sp+CL

Comp_Edge=NE+Vim_Edge
Comp_Edge_Sphere=Comp_Edge+Sp_Edge
Comp_Edge_complete=Comp_Edge_Sphere+NE_Spike

allocate(X(Comp_Spike),Y(Comp_Spike),Z(Comp_Spike))
allocate(RXX(Comp_Spike),RYY(Comp_Spike),RZZ(Comp_Spike))
allocate(E1(Comp_Edge_complete),E2(Comp_Edge_complete))
allocate(E_S1(NSN),E_S2(NSN))
allocate(P1(NT),P2(NT),P3(NT))
allocate(N1(NT),N2(NT),N3(NT))
allocate(FM_X(Comp_Spike),FM_Y(Comp_Spike),FM_Z(Comp_Spike))
allocate(Flag_Ignore(Comp_Spike,Comp_Spike),Flag_Contact(Comp_Spike,Comp_Spike))
allocate(R_0(Comp_Edge_complete))
allocate(Occupy_Spike(Comp_Spike),Occupy_Vim(Comp_Spike))



	Do I=1,Comp_Spike
		X(I)=0.d0
		Y(I)=0.d0
		Z(I)=0.d0

		FM_X(I)=0.d0
		FM_Y(I)=0.d0
		FM_Z(I)=0.d0
	End Do


	Do I=1,Comp_Edge_complete
		E1(I)=0
		E2(I)=0
		R_0(I)=0
	End Do

	Do I=1,NT
		P1(I)=0
		P2(I)=0
		P3(I)=0

		N1(I)=0
		N2(I)=0
		N3(I)=0
	End Do

	Do I=1,NSN
		E_S1(I)=0
		E_S2(I)=0
	End Do


	 Do I=1,Comp_Spike
	    Do J=1,Comp_Spike
		FLag_Ignore(I,J)=0
		Flag_Contact(I,J)=0
	    End Do
	 End Do

	Do I=1,Comp_Spike
		Occupy_Spike(I)=0
		Occupy_VIM(I)=0
	End Do

IF((NVF.GT.Pos_ACE2)) Then
	DO I=(CL-ACE2-SVN)+1,(CL-ACE2)
		 Do J=1,Comp_Spike
		 	FLag_Ignore(I,J)=1
			FLag_Ignore(J,I)=1
		End Do
	End Do
End IF




	Do I=1,Comp_Spike
		Read(10,*) X(I),Y(I),Z(I)
	End Do

	Do I=1,Comp_Spike
		RXX(I)=X(I)
		RYY(I)=Y(I)
		RZZ(I)=Z(I)
	End Do
 


 Do I=1,Comp_Edge_complete
	Read(20,*) E1(I),E2(I)
 End Do

 Do I=1,NSN
	Read(60,*) E_S1(I),E_S2(I)
 End Do

 Do I=1,NT
	Read(30,*) P1(I),P2(I),P3(I)
 End Do

 Do I=1,NT
	 Read(50,*) N1(I),N2(I),N3(I)
 End Do


	Do I=Comp_Edge+1,Comp_Edge_Sphere
		Ed1=E1(I)
		Ed2=E2(I)

		XR=X(Ed1)-X(Ed2)
		YR=Y(Ed1)-Y(Ed2)
		ZR=Z(Ed1)-Z(Ed2)

		R_0(I)=sqrt( XR*XR + YR*YR + ZR*ZR)
	End Do



Return
End subroutine Initial_Config


Subroutine File_Name
use parameters
implicit none


if( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i1,a1,i1,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i1,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i1,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i1,a1,i1,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i1,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i1,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i1,a1,i1,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i1,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i1,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i1,a1,i2,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i2,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i2,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i1,a1,i2,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i2,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i2,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i1,a1,i2,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i2,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i2,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i1,a1,i3,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i3,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i3,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i1,a1,i3,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i3,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i3,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i1,a1,i3,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i1,a1,i3,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<10).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i1,a1,i3,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

!_____________________________________________________________________________________________________________!

elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i2,a1,i1,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i1,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i1,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i2,a1,i1,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i1,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i1,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i2,a1,i1,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i1,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i1,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i2,a1,i2,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i2,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i2,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i2,a1,i2,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i2,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i2,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i2,a1,i2,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i2,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i2,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i2,a1,i3,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i3,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i3,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i2,a1,i3,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i3,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i3,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i2,a1,i3,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i2,a1,i3,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<100).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i2,a1,i3,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

!______________________________________________________________________________________________________________!

elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i3,a1,i1,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i1,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i1,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i3,a1,i1,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i1,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i1,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i3,a1,i1,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i1,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<10).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i1,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i3,a1,i2,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i2,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i2,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i3,a1,i2,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i2,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i2,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i3,a1,i2,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i2,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<100).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i2,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<10) )then          ! Setting name for files.
WRITE(filename110,'(a3,i3,a1,i3,a1,i1,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i3,a1,i1,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<10).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i3,a1,i1,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"

elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i3,a1,i3,a1,i2,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i3,a1,i2,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<100).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i3,a1,i2,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"


elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<10) )then          
WRITE(filename110,'(a3,i3,a1,i3,a1,i3,a1,i1,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<100) )then          
WRITE(filename110,'(a3,i3,a1,i3,a1,i3,a1,i2,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
elseif( (int(Ben)<1000).and.(int(Sp_No)<1000).and.(int(VD)<1000).and.(int(Ens)<1000) )then          
WRITE(filename110,'(a3,i3,a1,i3,a1,i3,a1,i3,a4)')"Mem",int(Ben),"_",int(Sp_No),"_",int(VD),"_",int(Ens),".dat"
end if

!__________________________________________________________________________________________________!


open(unit=100,file=filename110,form="unformatted")

return
end subroutine File_Name



FUNCTION gauss(seed,iset)
implicit none
integer :: seed,iset
real*8  :: gauss,w_gfx
real*8  :: x1,x2,ran2,fac
save fac,x2

w_gfx=2.0

if (iset==0) then
	do while(w_gfx>=1.0) 
		x1=(2.0*ran2(seed))-1.0
		x2=(2.0*ran2(seed))-1.0
		w_gfx=(x1*x1)+(x2*x2)
	end do
	fac=sqrt(-2.0*log(w_gfx)/w_gfx) 
	gauss=x1*fac
	iset=1
else	
	
	gauss=x2*fac
	iset=0
end if


return
end function gauss



SUBROUTINE init_random_seed()
            INTEGER :: i, n, clock
            INTEGER, DIMENSION(:), ALLOCATABLE :: seed

            CALL RANDOM_SEED(size = n)
            ALLOCATE(seed(n))

            CALL SYSTEM_CLOCK(COUNT=clock)

            seed = clock + 37 * (/ (i - 1, i = 1, n) /)
            CALL RANDOM_SEED(PUT = seed)

            DEALLOCATE(seed)
END SUBROUTINE



FUNCTION ran2(idum)
      INTEGER idum,IM1,IM2,IMM1,IA1,IA2,IQ1,IQ2,IR1,IR2,NTAB,NDIV
      real*8 ran2,AM,EPS,RNMX
      PARAMETER (IM1=2147483563,IM2=2147483399,AM=1./IM1,IMM1=IM1-1, &
      IA1=40014,IA2=40692,IQ1=53668,IQ2=52774,IR1=12211,IR2=3791, &
      NTAB=32,NDIV=1+IMM1/NTAB,EPS=1.2e-7,RNMX=1.-EPS)
      INTEGER idum2,j,k,iv(NTAB),iy
      SAVE iv,iy,idum2
      DATA idum2/123456789/, iv/NTAB*0/, iy/0/
      if (idum.le.0) then
        idum=max(-idum,1)
        idum2=idum
        do 11 j=NTAB+8,1,-1

          k=idum/IQ1
          idum=IA1*(idum-k*IQ1)-k*IR1
          if (idum.lt.0) idum=idum+IM1
          if (j.le.NTAB) iv(j)=idum
11      continue
        iy=iv(1)
      endif
      k=idum/IQ1
      idum=IA1*(idum-k*IQ1)-k*IR1
      if (idum.lt.0) idum=idum+IM1
      k=idum2/IQ2
      idum2=IA2*(idum2-k*IQ2)-k*IR2
      if (idum2.lt.0) idum2=idum2+IM2
      j=1+iy/NDIV
      iy=iv(j)-idum2
      iv(j)=idum
      if(iy.lt.1)iy=iy+IMM1
      ran2=min(AM*iy,RNMX)
      return
END
